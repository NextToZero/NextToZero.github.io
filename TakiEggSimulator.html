<!DOCTYPE html>
<html>

<head>
	<style>
		/* Primary Styling*/
		body {
			background-color: black;
			color: gray;

		}

		div {
			
		}

		h1 {
			color: red;
			text-align: center;

		}

		/* Distinct Styling */

		.panel{

			width: 33%;
			display: inline-block;
			opacity: 0.9;
			border-width: 3px;
			border-color: red;
		}

		#main_frame {


		}

		#main_frame>div {
			background-color: #242424;
			opacity: 0.90;
			margin-bottom: 10px;
			width: 100%;

		}

		#div_title {
			background-color: black;
			height: 80px;
			width: 100%;
		}

		#div_data {
			height: 50px;
			width: 100%;


		}

		#div_display {
			height: 150px;
			width: 100%px;
		}

		#display1 {
			opacity: 1.0;
		}

		#display2 {
			opacity: 0.75;
		}

		#display3 {
			opacity: 0.50
		}

		.btn-group {
			height: 50px;
			width: 100%;
			display: inline-block;

		}

		.button {
			width: 33%;
			height: 100%;
			display: inline-block;

			color: dark red;
		}

		.btn-group button {
			background-color: #880000;
			/* Green background */
			border: 1px solid red;
			/* Green border */
			color: white;
			/* White text */
			padding: 0px 0px;
			/* Some padding */
			cursor: pointer;
			/* Pointer/hand icon */
			float: left;
			/* Float the buttons side by side */
		}

		.btn-group button:not(:last-child) {
			border-right: none;
			/* Prevent double borders */
		}

		/* Clear floats (clearfix hack) */
		.btn-group:after {
			content: "";
			clear: both;
			display: table;
		}

		/* Add a background color on hover */
		.btn-group button:hover {
			background-color: #3e8e41;
		}

		.btn {
			cursor: pointer;
			text-align: center;
			text-decoration: none;
			outline: none;
			border: none;
			border-radius: 15px;
			box-shadow: 0 9px #999;
			height: 100%;

		}

		.btn:hover {
			background-color: #3e8e41
		}

		.btn:active {
			background-color: #3e8e41;
			box-shadow: 0 5px #666;
			transform: translateY(4px);
		}

		#datar1>p {
			color: red;
			float: left;
			padding-left: 20px;
		}

		#settings_frame {
			display: none;

		}
	</style>




</head>

<body>
	<div id="third_panel_left" class="panel">
		<div id="div_title">
			<h1> Taki E G G Simulator  </h1>
			<h6>The great UI update. Now with settings! v0.0.5</h6>
		</div>
		<div id="main_frame">
			<div id="div_data">
				<div id="datar1">
					<p id="egg_display"> Eggs: 0 </p>
					<p id="collector_display">Collectors: 0</p>
					<p id="collector_price_display">Collector Price: 10 </p>
					<p id="money_display" style="display:none;"> Money: 0</p>
					<p id="egg_sale_price_display" style="display:none;">Egg Price: 0</p>
				</div>
			</div>
			<div id="div_display">
				<p id="display3"></p>
				<p id="display2"></p>
				<p id="display1">It's a calm day. Work is slow, the sun is shining, and wait- Butters has brought you
					something. It's... an
					egg?</p>
			</div>
			<div id="div_buttonSet1" class="btn-group">
				<button id="btnGrabEgg" class="btn" style="width:33.3%" onclick="btnGrabEgg()"> Grab Egg </button>
				<button id="btnBuyCollector" class="btn" style="width:33.3%" onclick="btnBuyCollector()"> Buy Collector</button>
				<button id="btnTBD" class="btn" style="width:33.3%"> Locked </button>
			</div>
			<br>
			<div id="div_buttonSet1" class="btn-group">
				<button id="btnSellEggs" class="btn" style="width:33.3%" onclick=""> Locked </button>
				<button id="btnTBD" class="btn" style="width:33.3%" onclick=""> Locked </button>
				<button id="btnSettings" class="btn" style="width:33.3%" onclick="goto_settings()"> Settings </button>
				
			</div>

		</div>
		<div id="settings_frame">
			<div id="settings_pane">
				<H1> Settings </H1>
				<p> This will contain some other settings eventually. If you press Nuke, it will reload the page and wipe your progress. Think carefully. There is no confirm text.</p>
				<br>
				<div class="btn-group" style="padding-bottom: 20px;">
				<button id="btnNuke" class="btn" style="width:33.3%" onclick="NukeProgress()"> Nuke</button>
				</div>
				<br>
				<div class="btn-group">
					<button id="btn_settings_back" class="btn" style="width:33.3%"
						onclick="btn_settings_back()">Back</button>
				</div>
			</div>
		</div>

	</div>
	<div id="third_panel_mid" class="panel"> </div>
	<div id="third_panel_right" class="panel"> </div>  
</body>

<script>



	//Variables

	var eggTotal = 0;
	var tickrate = 1;
	var eggpertick = 0;
	//collector vars
	var collectorTotal = 0;
	var collectorCostMultiplier = 1.15;
	var collectorSpeedMultiplier = 1.5;
	var collectorPrice = 10;

	//sales vars
	var moneyTotal = 0;
	var eggSellPrice =0.17;
	var eggSalesUnlocked = false;

	
	var events = [10];
	const eventsmuliplier = 1.58;
	
	const eventdesc = [
		"Where... is she getting these from?",
		"You're starting to run out of desk space... surely there's somewhere you can put them for now.",
		"Your desk is covered in eggs. Where do these even come from?",
		"You've started to put them in bins outside. The neighbors are staring at you from the windows.",
		"You've asked, but nobody knows. There are no chickens for miles, and she's never gone that long.",
		"Butters brings in another egg. At this point, you've set up cameras to watch her at all times.",
		"Your weekly omelette nights are a huge hit. You've started to enjoy the taste, but you're not happy about it.",
		"You become extremely interested in shorting egg stocks.",
		"The business license arrives in the mail. You start to sell Butters's Farm Fresh Eggs in local stores.",
		"Customer reviews are in, and they're happier than ever. The only complaint is the dog hair in every carton.",
		"The market begins to oversaturate. Egg prices decline. You regret quitting your job... just a little bit.",
		"You're noticing a new smell. Butters stares up at you before dropping another egg from her mouth.",
		"You rent a storage locker on the outskirts of town. The smell is unbearable. The eggs accelerate.",
		"The Eggs Accelerate.",
		"The. Eggs. ACCELERATE.",
		"The storage locker can no longer contain the eggs. You purchase a warehouse, and set up a long chute.",
		"The City Health Inspector came today. He had an accident in the warehouse. They never found him among the eggs.",
		"You mutter to yourself over and over \"You have to crack a few eggs... To make an omelette... You have to crack a few eggs.\"",
		"Butters smiles up at you. You smile back at her. She brings you an egg. This is the end.",
		"Bruh stop. The game is over."
	];



	function goto_settings() {

		document.getElementById("settings_frame").style.display = "initial";
		document.getElementById("main_frame").style.display = "none";


	}

	function btn_settings_back() {

		document.getElementById("settings_frame").style.display = "none";
		document.getElementById("main_frame").style.display = "initial";


	}


	//generateEvents//
	//dynamically creates events array based on a multiplier. Multiplier set above, currently 1.58x
	function generateEvents() {

		for (i = 1; i < eventdesc.length; i++) {
			eventnum = Math.floor(events[i - 1] * eventsmuliplier);
			events.push(eventnum)


		}

		events.push(1000000);
		console.log(events);
		console.log(eventdesc);
	}


	//checkEggEvent//
	//Check current total against events array. Runs through the entire events array every single run of the function.
	//Calls the displayUpdate function when number is between i and i+1. 
	function checkEggEvent() {
		for (let i = 0; i < events.length; i++) {

			if (eggTotal > events[i] && eggTotal < events[i + 1]) { updateFeedDisplay(eventdesc[i]) }

		}
		if(eggTotal >= 400){

			startEggSales();
	
		}
	}

	function startEggSales(){
			eggSalesUnlocked = true;
			document.getElementById("btnSellEggs").onclick = function(){btnSellEggs()};
			document.getElementById("btnSellEggs").innerHTML= "Sell Eggs";

	}

	//onClick Grab Egg. 
	function btnGrabEgg() {
		console.info("clicked btnGrabEgg");
		eggTotal += 1;
		checkEggEvent();
		updateEggDisplay();

	}
	//onClick for btnBuyCollector. I'll rename this NEVER. Just kidding, I renamed it 12/19/2022 

	function btnBuyCollector() {
		console.info("clicked btnBuyCollector");
		buycollector();

	}

	function btnSellEggs()
	{

		sellEggs();

	}


	function NukeProgress() {

		//𓀥    𓁆 𓀕
		//
		//𓁆 𓀟   𓀣 𓁀

		localStorage.clear();
		location.reload();

	}



	//buyCollector//
	//when called, add one to total. For first collector a special display message posted. More to follow eventually.
	function buycollector() {

		if (eggTotal >= collectorPrice) {
			eggTotal -= collectorPrice;
			collectorTotal += 1;
			if (collectorTotal == 1) { updateFeedDisplay("You've purchased your first collector. Now, she has somewhere to put them."); }
			collectorPrice = Math.floor(collectorCostMultiplier * collectorPrice);
			updateCollectorDisplay();
			updateCollectorPriceDisplay();
			updateEggDisplay();
		}
	}

	function sellEggs(){

		if(eggTotal > 0 ){
			eggvalue = eggTotal * eggSellPrice;
			moneyTotal += eggvalue;
			updateFeedDisplay("You have sold " + eggTotal + " eggs, at a total value of $" + eggvalue.toFixed(2) + ".");


			eggTotal = 0;
		}
		updateMoneyDisplay();
		updateEggPriceDisplay();
		updateEggDisplay();
		
	}

	function updateFeedDisplay(eventtext) {
		var currenttext = document.getElementById("display1").innerHTML;
		if (currenttext != eventtext) {
			document.getElementById("display3").innerHTML = document.getElementById("display2").innerHTML;
			document.getElementById("display2").innerHTML = document.getElementById("display1").innerHTML;
			document.getElementById("display1").innerHTML = eventtext
		}

	}


	function updateEggDisplay() {
		document.getElementById("egg_display").innerHTML = "Eggs: " + eggTotal;
	}

	function updateCollectorPriceDisplay() {
		document.getElementById("collector_price_display").innerHTML = "Collector Price: " + collectorPrice;
	}

	function updateMoneyDisplay() {
		document.getElementById("money_display").innerHTML = "Money: " + moneyTotal.toFixed(2);
		document.getElementById("money_display").style.display = "initial";
	}

	function updateEggPriceDisplay() {
		document.getElementById("egg_sale_price_display").innerHTML = "Egg price: " + eggSellPrice;
		document.getElementById("egg_sale_price_display").style.display = "initial";
	}


	function updateCollectorDisplay() {
		document.getElementById("collector_display").innerHTML = "Collectors: " + collectorTotal;
	}
	//eggtick//
	//Butters gives you an egg.//
	//adds eggs to total, checks for events, updates display.
	function eggtick(num) {
		eggTotal += num;
		checkEggEvent();
		updateEggDisplay();
	}

	function updateAllDisplays() {
		console.log("Display Update");
		updateCollectorDisplay();
		updateCollectorPriceDisplay();
		updateEggDisplay();

		if(eggSalesUnlocked == true){
		updateEggPriceDisplay;
		updateMoneyDisplay;
		}

	}


	//saveState()//
	//Create a save object, populate with variables, load into localstorage as a json string. 
	function saveState() {
		var save = {
			eggTotal: eggTotal,
			collectorTotal: collectorTotal,
			collectorPrice: collectorPrice,
			eggSellPrice : eggSellPrice,
			moneyTotal : moneyTotal,
			eggSalesUnlocked: eggSalesUnlocked,
			display1: document.getElementById("display1").innerHTML,
			display2: document.getElementById("display2").innerHTML,
			display3: document.getElementById("display3").innerHTML

		}

		localStorage.setItem("save", JSON.stringify(save));

	}
	//loadState()//
	//Creates a savegame object, recalls the Save from localstorage and de-jsons it. if it's not null, load data.
	function loadState() {
		var savegame = JSON.parse(localStorage.getItem("save"));
		if (savegame != null) {
			if (typeof savegame.eggTotal !== "undefined") { eggTotal = savegame.eggTotal }
			if (typeof savegame.collectorTotal !== "undefined") { collectorTotal = savegame.collectorTotal }
			if (typeof savegame.collectorPrice !== "undefined") { collectorPrice = savegame.collectorPrice }
			if (typeof savegame.eggSellPrice !== "undefined") { eggSellPrice = savegame.eggSellPrice }
			if (typeof savegame.moneyTotal !== "undefined") { moneyTotal = savegame.moneyTotal }
			if (typeof savegame.eggSalesUnlocked !== "undefined") { eggSalesUnlocked = savegame.eggSalesUnlocked }
			if (typeof savegame.display1 !== "undefined") { document.getElementById("display1").innerHTML = savegame.display1 }
			if (typeof savegame.display2 !== "undefined") { document.getElementById("display2").innerHTML = savegame.display2 }
			if (typeof savegame.display3 !== "undefined") { document.getElementById("display3").innerHTML = savegame.display3 }

		}

		updateAllDisplays();
		logLoad();

	}

	function logLoad() {
		console.log("Loaded eggTotal: " + eggTotal);
		console.log("Loaded collectorTotal: " + collectorTotal);
		console.log("Loaded collectorPrice: " + collectorPrice);
		console.log("Loaded eggSellPrice: " + eggSellPrice);
		console.log("Loaded moneyTotal: " + moneyTotal);
		console.log("Loaded eggSalesUnlocked: " + eggSalesUnlocked);
		console.log("Loaded display1: " + display1);
		console.log("Loaded display2: " + display2);
		console.log("Loaded display3: " + display3);

	}


	function startup() {
		loadState();
		generateEvents();

	}
	startup()

	//I don't know why this works, but it do.
	window.setInterval(function () {
		eggtick(Math.floor(collectorTotal * collectorSpeedMultiplier));
		saveState();


	}, 1000);



	// do my inconsistent semicolons infuriate you? good. //


</script>



</html>